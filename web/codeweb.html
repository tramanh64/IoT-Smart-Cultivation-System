<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Theo D√µi C√¢y Tr·ªìng</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #2e7d32;
            --secondary-color: #4caf50;
            --light-color: #8bc34a;
            --background-color: #f1f8e9;
            --text-color: #1b5e20;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --active-color: #00c853;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--background-color);
            color: var(--text-color);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 24px;
            background-color: var(--light-color);
            color: white;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background-color 0.3s;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        
        .tab.active {
            background-color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.5s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .sensor-card {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .sensor-card:hover {
            transform: translateY(-5px);
        }
        
        .sensor-icon {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .sensor-value {
            font-size: 32px;
            font-weight: bold;
            margin: 10px 0;
            color: var(--primary-color);
        }
        
        .sensor-label {
            font-size: 16px;
            color: #666;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        
        .chart-box {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            height: 400px;
        }
        
        /* Controls Styling */
        .control-section {
            margin-bottom: 30px;
        }
        
        .control-heading {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .pump-control {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .pump-name {
            font-size: 18px;
            font-weight: 600;
        }
        
        .pump-status {
            display: flex;
            align-items: center;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            background-color: #ccc;
        }
        
        .status-indicator.active {
            background-color: var(--active-color);
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--active-color);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .parameters-form {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-group input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .mode-selector {
            margin-bottom: 20px;
        }
        
        .mode-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .mode-card {
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
        }
        
        .mode-card.active {
            border-color: var(--primary-color);
            background-color: rgba(76, 175, 80, 0.1);
        }
        
        .mode-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .mode-icon {
            font-size: 30px;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        button.save-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
        }
        
        button.save-btn:hover {
            background-color: var(--secondary-color);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tabs {
                overflow-x: auto;
                white-space: nowrap;
                padding-bottom: 5px;
            }
        }
        
        @media (max-width: 480px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .pump-control {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .pump-status {
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Dashboard C√¢y Tr·ªìng</h1>
            <div id="current-time">00:00:00</div>
        </header>
        
        <div class="tabs">
            <button class="tab active" onclick="openTab('dashboard')">Dashboard</button>
            <button class="tab" onclick="openTab('control')">ƒêi·ªÅu Khi·ªÉn B∆°m</button>
            <button class="tab" onclick="openTab('settings')">C√†i ƒê·∫∑t</button>
        </div>
        
        <div id="dashboard" class="tab-content active">
            <div class="dashboard-grid">
                <div class="sensor-card">
                    <div class="sensor-icon">üå°Ô∏è</div>
                    <div class="sensor-value" id="temperature">28¬∞C</div>
                    <div class="sensor-label">Nhi·ªát ƒê·ªô</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">üíß</div>
                    <div class="sensor-value" id="humidity">65%</div>
                    <div class="sensor-label">ƒê·ªô ·∫®m Kh√¥ng Kh√≠</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">‚òÄÔ∏è</div>
                    <div class="sensor-value" id="light">680 Lux</div>
                    <div class="sensor-label">√Ånh S√°ng</div>
                </div>
                
                <div class="sensor-card">
                    <div class="sensor-icon">üå±</div>
                    <div class="sensor-value" id="soil-moisture">42%</div>
                    <div class="sensor-label">ƒê·ªô ·∫®m ƒê·∫•t</div>
                </div>
            </div>
            
            <div class="charts-container">
                <div class="chart-box">
                    <canvas id="main-chart"></canvas>
                </div>
            </div>
        </div>
        
        <div id="control" class="tab-content">
            <div class="control-section">
                <h2 class="control-heading">ƒêi·ªÅu Khi·ªÉn B∆°m N∆∞·ªõc</h2>
                
                <div class="pump-control">
                    <div class="pump-name">B∆°m N∆∞·ªõc #1</div>
                    <div class="pump-status">
                        <div class="status-indicator" id="pump1-indicator"></div>
                        <span id="pump1-status-text">T·∫Øt</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="pump1-toggle" onchange="togglePump(1, this.checked)">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="pump-control">
                    <div class="pump-name">B∆°m N∆∞·ªõc #2</div>
                    <div class="pump-status">
                        <div class="status-indicator" id="pump2-indicator"></div>
                        <span id="pump2-status-text">T·∫Øt</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="pump2-toggle" onchange="togglePump(2, this.checked)">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div class="control-section">
                <h2 class="control-heading">Ch·∫ø ƒê·ªô T·ª± ƒê·ªông</h2>
                
                <div class="mode-selector">
                    <div class="mode-cards">
                        <div class="mode-card" onclick="selectMode('manual')" id="mode-manual">
                            <div class="mode-icon">üëã</div>
                            <h3>Th·ªß C√¥ng</h3>
                            <p>ƒêi·ªÅu khi·ªÉn b∆°m b·∫±ng tay</p>
                        </div>
                        
                        <div class="mode-card" onclick="selectMode('auto')" id="mode-auto">
                            <div class="mode-icon">ü§ñ</div>
                            <h3>T·ª± ƒê·ªông</h3>
                            <p>D·ª±a v√†o c·∫£m bi·∫øn ƒë·ªô ·∫©m</p>
                        </div>
                        
                        <div class="mode-card" onclick="selectMode('schedule')" id="mode-schedule">
                            <div class="mode-icon">‚è∞</div>
                            <h3>L·ªãch Tr√¨nh</h3>
                            <p>T∆∞·ªõi theo l·ªãch c·ªë ƒë·ªãnh</p>
                        </div>
                        
                        <div class="mode-card" onclick="selectMode('smart')" id="mode-smart">
                            <div class="mode-icon">üß†</div>
                            <h3>Th√¥ng Minh</h3>
                            <p>D·ª±a v√†o nhi·ªÅu y·∫øu t·ªë</p>
                        </div>
                    </div>
                </div>
                
                <div class="parameters-form">
                    <div class="form-group">
                        <label for="soil-moisture-threshold">Ng∆∞·ª°ng ƒê·ªô ·∫®m ƒê·∫•t (%):</label>
                        <input type="number" id="soil-moisture-threshold" min="0" max="100" value="30">
                    </div>
                    <div class="form-group">
                        <label for="pump-duration">Th·ªùi Gian B∆°m (gi√¢y):</label>
                        <input type="number" id="pump-duration" min="1" max="300" value="60">
                    </div>
                    <div class="form-group">
                        <label for="pump-cooldown">Th·ªùi Gian Ngh·ªâ (ph√∫t):</label>
                        <input type="number" id="pump-cooldown" min="1" max="1440" value="60">
                    </div>
                    
                    <button class="save-btn" onclick="saveSettings()">L∆∞u C√†i ƒê·∫∑t</button>
                </div>
            </div>
        </div>
        
        <div id="settings" class="tab-content">
            <div class="control-section">
                <h2 class="control-heading">C√†i ƒê·∫∑t H·ªá Th·ªëng</h2>
                
                <div class="parameters-form">
                    <h3 style="margin-bottom: 15px;">C√†i ƒê·∫∑t C·∫£nh B√°o</h3>
                    
                    <div class="form-group">
                        <label for="temp-min">Nhi·ªát ƒê·ªô T·ªëi Thi·ªÉu (¬∞C):</label>
                        <input type="number" id="temp-min" min="0" max="50" value="15">
                    </div>
                    <div class="form-group">
                        <label for="temp-max">Nhi·ªát ƒê·ªô T·ªëi ƒêa (¬∞C):</label>
                        <input type="number" id="temp-max" min="0" max="50" value="35">
                    </div>
                    <div class="form-group">
                        <label for="humidity-min">ƒê·ªô ·∫®m Kh√¥ng Kh√≠ T·ªëi Thi·ªÉu (%):</label>
                        <input type="number" id="humidity-min" min="0" max="100" value="40">
                    </div>
                    <div class="form-group">
                        <label for="soil-min">ƒê·ªô ·∫®m ƒê·∫•t T·ªëi Thi·ªÉu (%):</label>
                        <input type="number" id="soil-min" min="0" max="100" value="20">
                    </div>
                    
                    <h3 style="margin: 25px 0 15px;">C√†i ƒê·∫∑t L·ªãch Tr√¨nh</h3>
                    
                    <div class="form-group">
                        <label for="schedule-morning">Th·ªùi Gian T∆∞·ªõi Bu·ªïi S√°ng:</label>
                        <input type="time" id="schedule-morning" value="06:00">
                    </div>
                    <div class="form-group">
                        <label for="schedule-evening">Th·ªùi Gian T∆∞·ªõi Bu·ªïi T·ªëi:</label>
                        <input type="time" id="schedule-evening" value="18:00">
                    </div>
                    
                    <button class="save-btn" onclick="saveSystemSettings()">L∆∞u C√†i ƒê·∫∑t</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab Switching
        function openTab(tabName) {
            const tabContents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            const tabs = document.getElementsByClassName("tab");
            for (let i = 0; i < tabs.length; i++) {
                tabs[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            event.currentTarget.classList.add("active");
        }
        
        // Update current time
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            document.getElementById("current-time").textContent = timeString;
        }
        
        setInterval(updateTime, 1000);
        updateTime();
        
        // Chart initialization
        const ctx = document.getElementById('main-chart').getContext('2d');
        const mainChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Nhi·ªát ƒê·ªô (¬∞C)',
                        data: [],
                        borderColor: '#f44336',
                        backgroundColor: 'rgba(244, 67, 54, 0.1)',
                        tension: 0.4,
                        borderWidth: 2,
                        fill: true
                    },
                    {
                        label: 'ƒê·ªô ·∫®m Kh√¥ng Kh√≠ (%)',
                        data: [],
                        borderColor: '#2196f3',
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        tension: 0.4,
                        borderWidth: 2,
                        fill: true
                    },
                    {
                        label: 'ƒê·ªô ·∫®m ƒê·∫•t (%)',
                        data: [],
                        borderColor: '#4caf50',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        tension: 0.4,
                        borderWidth: 2,
                        fill: true
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'D·ªØ Li·ªáu C·∫£m Bi·∫øn Theo Th·ªùi Gian Th·ª±c',
                        font: {
                            size: 16
                        }
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    },
                    legend: {
                        position: 'top',
                    }
                },
                scales: {
                    x: {
                        title: {
                            display: true,
                            text: 'Th·ªùi Gian'
                        }
                    },
                    y: {
                        min: 0,
                        max: 100,
                        title: {
                            display: true,
                            text: 'Gi√° Tr·ªã'
                        }
                    }
                }
            }
        });
        
        // Pump controls
        function togglePump(pumpId, status) {
            const indicator = document.getElementById(`pump${pumpId}-indicator`);
            const statusText = document.getElementById(`pump${pumpId}-status-text`);
            
            if (status) {
                indicator.classList.add('active');
                statusText.textContent = 'B·∫≠t';
            } else {
                indicator.classList.remove('active');
                statusText.textContent = 'T·∫Øt';
            }
            
            // N∆°i g·ª≠i l·ªánh ƒë·∫øn b∆°m n∆∞·ªõc th√¥ng qua API ho·∫∑c MQTT
            console.log(`B∆°m #${pumpId} ${status ? 'b·∫≠t' : 't·∫Øt'}`);
        }
        
        // Mode selection
        function selectMode(mode) {
            const modeCards = document.querySelectorAll('.mode-card');
            modeCards.forEach(card => {
                card.classList.remove('active');
            });
            
            document.getElementById(`mode-${mode}`).classList.add('active');
            
            // L∆∞u ch·∫ø ƒë·ªô v√† hi·ªÉn th·ªã c√°c t√πy ch·ªçn t∆∞∆°ng ·ª©ng
            currentMode = mode;
            updateModeUI(mode);
        }
        
        function updateModeUI(mode) {
            // Hi·ªÉn th·ªã c√°c t√πy ch·ªçn d·ª±a v√†o ch·∫ø ƒë·ªô
            // ƒê√¢y l√† n∆°i ƒë·ªÉ th√™m logic hi·ªÉn th·ªã/·∫©n c√°c tr∆∞·ªùng t√πy thu·ªôc v√†o ch·∫ø ƒë·ªô
            console.log(`Ch·∫ø ƒë·ªô ${mode} ƒë∆∞·ª£c ch·ªçn`);
        }
        
        // Save settings
        function saveSettings() {
            const soilMoistureThreshold = document.getElementById('soil-moisture-threshold').value;
            const pumpDuration = document.getElementById('pump-duration').value;
            const pumpCooldown = document.getElementById('pump-cooldown').value;
            
            // L∆∞u c√†i ƒë·∫∑t v√† g·ª≠i ƒë·∫øn h·ªá th·ªëng
            const settings = {
                mode: currentMode,
                soilMoistureThreshold,
                pumpDuration,
                pumpCooldown
            };
            
            console.log('C√†i ƒë·∫∑t ƒë√£ l∆∞u:', settings);
            alert('C√†i ƒë·∫∑t ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
        }
        
        function saveSystemSettings() {
            const tempMin = document.getElementById('temp-min').value;
            const tempMax = document.getElementById('temp-max').value;
            const humidityMin = document.getElementById('humidity-min').value;
            const soilMin = document.getElementById('soil-min').value;
            const scheduleMorning = document.getElementById('schedule-morning').value;
            const scheduleEvening = document.getElementById('schedule-evening').value;
            
            // L∆∞u c√†i ƒë·∫∑t h·ªá th·ªëng
            const systemSettings = {
                tempMin,
                tempMax,
                humidityMin,
                soilMin,
                scheduleMorning,
                scheduleEvening
            };
            
            console.log('C√†i ƒë·∫∑t h·ªá th·ªëng ƒë√£ l∆∞u:', systemSettings);
            alert('C√†i ƒë·∫∑t h·ªá th·ªëng ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng!');
        }
        
        // Simulation for testing
        let currentMode = 'manual';
        
        function simulateSensorData() {
            // Gi·∫£ l·∫≠p d·ªØ li·ªáu c·∫£m bi·∫øn
            const temperature = Math.floor(25 + Math.random() * 10);
            const humidity = Math.floor(60 + Math.random() * 20);
            const light = Math.floor(600 + Math.random() * 400);
            const soilMoisture = Math.floor(35 + Math.random() * 30);
            
            // C·∫≠p nh·∫≠t gi√° tr·ªã hi·ªÉn th·ªã
            document.getElementById('temperature').textContent = `${temperature}¬∞C`;
            document.getElementById('humidity').textContent = `${humidity}%`;
            document.getElementById('light').textContent = `${light} Lux`;
            document.getElementById('soil-moisture').textContent = `${soilMoisture}%`;
            
            // C·∫≠p nh·∫≠t d·ªØ li·ªáu bi·ªÉu ƒë·ªì
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            
            // Th√™m d·ªØ li·ªáu v√†o bi·ªÉu ƒë·ªì
            if (mainChart.data.labels.length > 10) {
                mainChart.data.labels.shift();
                mainChart.data.datasets.forEach(dataset => {
                    dataset.data.shift();
                });
            }
            
            mainChart.data.labels.push(timeString);
            mainChart.data.datasets[0].data.push(temperature);
            mainChart.data.datasets[1].data.push(humidity);
            mainChart.data.datasets[2].data.push(soilMoisture);
            
            mainChart.update();
            
            // Ki·ªÉm tra ch·∫ø ƒë·ªô t·ª± ƒë·ªông
            if (currentMode === 'auto') {
                const threshold = parseInt(document.getElementById('soil-moisture-threshold').value);
                if (soilMoisture < threshold && !document.getElementById('pump1-toggle').checked) {
                    document.getElementById('pump1-toggle').checked = true;
                    togglePump(1, true);
                } else if (soilMoisture >= threshold && document.getElementById('pump1-toggle').checked) {
                    document.getElementById('pump1-toggle').checked = false;
                    togglePump(1, false);
                }
            }
        }
        
        // Kh·ªüi t·∫°o v√† b·∫Øt ƒë·∫ßu gi·∫£ l·∫≠p
        selectMode('manual'); // Ch·ªçn ch·∫ø ƒë·ªô m·∫∑c ƒë·ªãnh
        setInterval(simulateSensorData, 2000); // C·∫≠p nh·∫≠t m·ªói 2 gi√¢y
        simulateSensorData(); // Ch·∫°y l·∫ßn ƒë·∫ßu
    </script>
</body>
</html>